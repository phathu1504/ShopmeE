<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/fragment :: page_head(${pageTitle})" />
<body>
	<div class="container-fluid">

		<div th:replace="fragments/navigation :: menu"></div>

		<div>
			<h2>Manager Categories | [[${titlePage}]]</h2>
		</div>
		
		<div>
			
			<form th:action="@{/categories/save}" method="post" style="max-width:700px; margin: 0 auto"
				 th:object="${category}"
				 enctype="multipart/form-data">
				<input type="hidden" th:field="*{id}">
				<div class="border border-secondary rounded p-3">
					<div class="form-group row mt-2">
						<label class="col-sm-4 col-form-label">Category Name:</label>
						<div class="col-sm-8">
							<input type="type" class="form-control" th:field="*{name}" required minlength="3" maxlength="128">
						</div>
					</div>
					
					<div class="form-group row mt-2">
						<label class="col-sm-4 col-form-label">Alias:</label>
						<div class="col-sm-8">
							<input type="text" class="form-control" th:field="*{firstName}" required minlength="2" maxlength="50">
						</div>
					</div>
					
					<div class="form-group row mt-2">
						<label class="col-sm-4 col-form-label">Parent Category:</label>
						<div class="col-sm-8">
							<select>
							
							</select>
						</div>
					</div>

					<div class="form-group row mt-2">
						<label class="col-sm-4 col-form-label">Enabled:</label>
						<div class="col-sm-8">
							<input type="checkbox" th:field="*{enabled}">
						</div>
					</div>
					
					<div class="form-group row mt-2">
						<label class="col-sm-4 col-form-label">Image:</label>
						<div class="col-sm-8">
							<input type="hidden" th:field="*{image}">
							<input type="file" id="fileImage" name="image" accept="image/png, image/jpeg"
								class="mb-2" >
							<img id="thumbnail" alt="Image Preview"
								class="img-fluid" >
						</div>
					</div>
					
					<div class="text-center">
						<input type="submit" value="Save" class="btn btn-primary m-3">
						<input type="button" value="Cancel" class="btn btn-secondary" id="buttonCancel">
					</div>
				</div>
			</form>
			
		</div>

		<div th:replace="fragments/fragment :: footer"></div>
	</div>
<script type="text/javascript">
	
	moduleURL = "[[@{/categories}]]";

	$(document).ready(function() {
	    $("#buttonCancel").on("click", function() {
	        window.location = "/ShopmeAdmin/users"; // Điều hướng đến trang "Users"
	    });
	    
	    $("#fileImage").change(function(){
	    	fileSize = this.files[0].size;
	    	
	    	if(fileSize > 1048576) {
	    		this.setCustomValidity("You must choose an image less than 1MB!");
	    		this.reportValidity();
	    	} else {
	    		this.setCustomValidity("");
	    		showImageThumbnail(this);
	    	}

	    })
	});
	
	function showImageThumbnail(fileInput){
		var file = fileInput.files[0];
		var reader = new FileReader();
		reader.onload = function(e){
			$("#thumbnail").attr("src", e.target.result);
		}
		reader.readAsDataURL(file);
	}

    

</script>
</body>
</html>